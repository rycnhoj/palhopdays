<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Pal Hop Days</title>
  <script type="text/javascript" src="http://www.youtube.com/player_api"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
    crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/css?family=Chewy|Open+Sans" rel="stylesheet">
  <link rel="stylesheet" href="./css/custom.css">
  <script>
    var pages = ['home', 'about', 'bands', 'videos', 'shop', 'sponsorship']
    var bandVideos = {
      'MD': '0AHibdNSVk8',
      'TTT': 'RTk5-BSh8ag',
      'RK': 'dFd5yPSsXV0',
      'TI': '1bfX53tC6b8',
      'TRR': 'Q_89WxaCANo',
      'TT': 'iZmjZpVomaU',
      'BE': 'xMlTqVBFmwM'
    }
    var bandTitles = {
      'MD': 'The Moon Dawgs',
      'TTT': 'Terry and The Telstars',
      'RK': 'The Royal Knights',
      'TI': 'The Innkeepers',
      'TRR': 'The Rockin\' Recons',
      'TT': 'The Travelers',
      'BE': 'Bob Elie'
    }
    var firstBand = 'MD'
    var aboutData
    var bandsData

    $(document).ready(function() {
      pages.forEach(function (page) { $('.' + page).hide() })

      $.getJSON('./data/about.json', function (resp) { aboutData = resp }).then(function() {
        $('.about-headline').append('<h3>' + aboutData.headline[0] + '</h3>')
        aboutData.about.forEach(function (section) {
          $('.about-text').append('<p>' + section + '</p>')
        })
      })

      $.getJSON('./data/bands.json', function (resp) { bandsData = resp })

      var bandButton = $('.bands-button').show()
      var bandSelect = $('.band-select').hide()

      bandButton.mouseenter(function() {
        bandSelect.show();
        $(this).hide();
      })

      bandSelect.mouseleave(function() {
        bandButton.show();
        $(this).hide();
      })
    })


    // YouTube
    var homeVideoPlayer, bandVideoPlayer

    function onYouTubeIframeAPIReady() {
      var vars = {
        'autoplay': 0,
        'controls': 1 ,
        'enablejsapi': 1,
        'modestbranding': 1,
        'rel': 0,
        'showinfo': 0
      }

      homeVideoPlayer = new YT.Player('homeVideo', {
        videoId: 'PO3cKEZ7UcE',
        playerVars: vars,
        events: { 'onReady': homeVideoPlayerReady }
      })

      bandVideoPlayer = new YT.Player('bandVideo', {
        videoId: bandVideos[firstBand],
        playerVars: vars,
        events: { 'onReady': bandVideoPlayerReady }
      })

      posterVideoPlayer = new YT.Player('posterVideo', {
        videoId: 'SWYucDQ9uNY',
        playerVars: vars,
        events: { 'onReady': posterVideoPlayerReady }
      })
    }

    // Player Ready Control

    var homeReady, bandReady, posterReady

    function homeVideoPlayerReady() {
      homeReady = true
      onPlayerReady()
    }

    function bandVideoPlayerReady() {
      bandReady = true
      onPlayerReady()
    }

    function posterVideoPlayerReady() {
      posterReady = true
      onPlayerReady()
    }

    function onPlayerReady() {
      if(homeReady && bandReady & posterReady) {
        checkUrlForPage()
      }
    }

    // Handle page nav
    function checkUrlForPage() {
      var pageNav = window.location.hash.substr(1);
      if(pageNav) {
        changePage(pageNav)
      } else {
        changePage('home')
      }
    }

    // Changing pages
    function changePage(mode) {
      pages.forEach(function (page) {

        if(page !== 'home') {
          homeVideoPlayer.stopVideo()
        } else if (page !== 'bands'){
          bandVideoPlayer.stopVideo()
        }

        if(page === 'about') {

        }

        if(page === 'bands') {
          changeBandVideo(firstBand)
          bandVideoPlayer.stopVideo()
        }

        if(page === mode) {
          window.history.pushState(mode, "Title", "#" + mode); //Update Url
          $('.nav-' + page).addClass('text-underline')
          $('.' + page).show()
        } else {
          $('.nav-' + page).removeClass('text-underline')
          $('.' + page).hide()
        }
      })
    }

    // Changing band videos
    function changeBandVideo(bandId) {
      var poster = $('.band-poster')
      var description = $('.band-description').empty()
      var videoId = bandVideos[bandId]
      var paragraphs = bandsData[bandId]

      poster.attr('src','./images/posters/' + bandId + '.jpg');
      bandVideoPlayer.loadVideoById({'videoId': videoId});
      paragraphs.forEach(function (paragrpah) {
        description.append('<p class="band">' + paragrpah + '</p>')
      })

      updateSelectedBand(bandId)
    }

    function updateSelectedBand(bandId) {
      var bandImages = $('.band-image').toArray()

      bandImages.forEach(function (image) {
        if(image.id === bandId) {
          $(image).addClass('active')
        } else {
          $(image).removeClass('active')
        }
      })
    }
  </script>
</head>

<body>
  <div class="center">
    <nav class="navbar">
      <a class="navbar-brand" onclick="changePage('home')"></a>
      <ul class="navbar-nav">
        <li>
          <a class='nav-about' onclick="changePage('about')">about</a>
        </li>
        <li>
          <a class='nav-bands' onclick="changePage('bands')">bands</a>
        </li>
        <li>
            <a class='nav-videos' onclick="changePage('videos')">videos</a>
        </li>
        <li>
          <a class='nav-shop' onclick="changePage('shop')">shop</a>
        </li>
      </ul>
    </nav>
    <div class="content">
      <div class="home">
        <div class="embed-responsive embed-responsive-16by9">
          <div id="homeVideo" class="embed-responsive-item"></div>
        </div>
      </div>
      <div class="about">
        <div class="row">
          <div class="left-side col-lg-5">
            <img class="about-poster img-responsive" src="./images/poster.jpg"/>
          </div>
          <div class="rigt-side col-lg-7">
            <div class="about-headline"></div>
            <div class="about-text"></div>
          </div>
        </div>
      </div>
      <div class="bands">
        <div class="bands-button"><h3>select band</h3></div>
        <div class="band-select row">
          <div class="col-lg-2"><img id="MD" class="band-image img-responsive" onclick='changeBandVideo(this.id)' src="./images/posters/MD.jpg"></div>
          <div class="col-lg-2"><img id="RK" class="band-image img-responsive" onclick='changeBandVideo(this.id)' src="./images/posters/RK.jpg"></div>
          <div class="col-lg-2"><img id="TI" class="band-image img-responsive" onclick='changeBandVideo(this.id)' src="./images/posters/TI.jpg"></div>
          <div class="col-lg-2"><img id="TRR" class="band-image img-responsive" onclick='changeBandVideo(this.id)' src="./images/posters/TRR.jpg"></div>
          <div class="col-lg-2"><img id="TT" class="band-image img-responsive" onclick='changeBandVideo(this.id)' src="./images/posters/TT.jpg"></div>
          <div class="col-lg-2"><img id="TTT" class="band-image img-responsive" onclick='changeBandVideo(this.id)' src="./images/posters/TTT.jpg"></div>
        </div>
        <div class="band-video row">
          <div class="col-lg-4 left-side">
            <img id="TTT" class="band-poster img-responsive" src="">
          </div>
          <div class="col-lg-8 right-side">
            <div class="embed-responsive embed-responsive-16by9">
              <div id="bandVideo"></div>
            </div>
            <div class="band-description"></div>
          </div>
        </div>
      </div>
      <div class="videos">
      </div>
      <div class="shop">
        <div class="row">
          <div class="left-side col-lg-3">
            <a href="https://www.bonanza.com/booths/billstuff?item_sort_options[custom_category_id]=626882"  target="_blank">
              <img class="shop-bill img-responsive" src="./images/shop/BillStuff.jpg">
            </a>
            <a href="https://hainesphotography.printeli.com/Collections/132957" target="_blank">
              <img class="shop-haines img-responsive" src="./images/shop/HainesPhotography.jpg">
            </a>
          </div>
          <div class="right-side col-lg-9">
            <div class="embed-responsive embed-responsive-16by9">
              <div id="posterVideo"></div>
            </div>
            <a href="https://www.google.com" target="_blank">
              <img class="shop-posters img-responsive" src="./images/shop/Posters.jpg">
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>

</html>